var areenaYlePage=function(){"use strict";function $(n){return n==null||typeof n=="function"?{main:n}:n}function G(n,s=1e4){return new Promise(async(e,t)=>{n()&&e(!0);const a=Date.now();let r=!1;for(;!r&&Date.now()<a+s;)await new Promise(o=>{setTimeout(()=>{r=n(),o()},1e3)});e(r)})}const F=n=>({id:w(n),...n}),w=n=>`${n.language}:${n.label}:${n.url}`;function B({onJson:n,onRequest:s,waitForBasename:e},t){setTimeout(()=>{const a={};let r="",o=!1;if(n!==void 0){const g=JSON.parse;JSON.parse=function(){const l=g.apply(this,arguments);let c=!1,b=!1;return n==null||n(l,d=>{const i=window.location.pathname;typeof a[i]>"u"&&(a[i]=[]);const m=w(d);a[i].find(h=>h.id===m)===void 0&&(a[i].push({id:m,...d}),c=!0)},d=>{r=d,b=!0}),o&&(c||b)&&document.dispatchEvent(new CustomEvent("asbplayer-synced-data",{detail:{error:"",basename:r,subtitles:a[window.location.pathname]}})),l}}function u(){for(const g of Object.keys(a))g!==window.location.pathname&&delete a[g]}document.addEventListener("asbplayer-get-synced-data",async()=>{s==null||s(l=>{const c=window.location.pathname;typeof a[c]>"u"&&(a[c]=[]);const b=w(l);a[c].find(d=>d.id===b)===void 0&&a[c].push({id:b,...l})},l=>{r=l,o||document.dispatchEvent(new CustomEvent("asbplayer-synced-data",{detail:{error:"",basename:r,subtitles:void 0}}))});const g=()=>window.location.pathname in a;g()||await G(g,t),document.dispatchEvent(new CustomEvent("asbplayer-synced-data",{detail:{error:"",basename:r,subtitles:a[window.location.pathname]??[]}})),u(),o=!0},!1)},0)}var P=function(){function n(){this.listeners={}}var s=n.prototype;return s.on=function(t,a){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(a)},s.off=function(t,a){if(!this.listeners[t])return!1;var r=this.listeners[t].indexOf(a);return this.listeners[t]=this.listeners[t].slice(0),this.listeners[t].splice(r,1),r>-1},s.trigger=function(t){var a=this.listeners[t];if(a)if(arguments.length===2)for(var r=a.length,o=0;o<r;++o)a[o].call(this,arguments[1]);else for(var u=Array.prototype.slice.call(arguments,1),g=a.length,l=0;l<g;++l)a[l].apply(this,u)},s.dispose=function(){this.listeners={}},s.pipe=function(t){this.on("data",function(a){t.push(a)})},n}();function R(){return R=Object.assign?Object.assign.bind():function(n){for(var s=1;s<arguments.length;s++){var e=arguments[s];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}return n},R.apply(this,arguments)}var C=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function H(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var y,M;function L(){if(M)return y;M=1;var n;return typeof window<"u"?n=window:typeof C<"u"?n=C:typeof self<"u"?n=self:n={},y=n,y}var Y=L();const v=H(Y);var V=function(s){return v.atob?v.atob(s):Buffer.from(s,"base64").toString("binary")};function k(n){for(var s=V(n),e=new Uint8Array(s.length),t=0;t<s.length;t++)e[t]=s.charCodeAt(t);return e}/*! @name m3u8-parser @version 6.0.0 @license Apache-2.0 */class K extends P{constructor(){super(),this.buffer=""}push(s){let e;for(this.buffer+=s,e=this.buffer.indexOf(`
`);e>-1;e=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)}}const j="	",D=function(n){const s=/([0-9.]*)?@?([0-9.]*)?/.exec(n||""),e={};return s[1]&&(e.length=parseInt(s[1],10)),s[2]&&(e.offset=parseInt(s[2],10)),e},q=function(){const e="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+e+")")},E=function(n){const s={};if(!n)return s;const e=n.split(q());let t=e.length,a;for(;t--;)e[t]!==""&&(a=/([^=]*)=(.*)/.exec(e[t]).slice(1),a[0]=a[0].replace(/^\s+|\s+$/g,""),a[1]=a[1].replace(/^\s+|\s+$/g,""),a[1]=a[1].replace(/^['"](.*)['"]$/g,"$1"),s[a[0]]=a[1]);return s};class _ extends P{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(s){let e,t;if(s=s.trim(),s.length===0)return;if(s[0]!=="#"){this.trigger("data",{type:"uri",uri:s});return}this.tagMappers.reduce((r,o)=>{const u=o(s);return u===s?r:r.concat([u])},[s]).forEach(r=>{for(let o=0;o<this.customParsers.length;o++)if(this.customParsers[o].call(this,r))return;if(r.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:r.slice(1)});return}if(r=r.replace("\r",""),e=/^#EXTM3U/.exec(r),e){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(e=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(r),e){t={type:"tag",tagType:"inf"},e[1]&&(t.duration=parseFloat(e[1])),e[2]&&(t.title=e[2]),this.trigger("data",t);return}if(e=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(r),e){t={type:"tag",tagType:"targetduration"},e[1]&&(t.duration=parseInt(e[1],10)),this.trigger("data",t);return}if(e=/^#EXT-X-VERSION:([0-9.]*)?/.exec(r),e){t={type:"tag",tagType:"version"},e[1]&&(t.version=parseInt(e[1],10)),this.trigger("data",t);return}if(e=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(r),e){t={type:"tag",tagType:"media-sequence"},e[1]&&(t.number=parseInt(e[1],10)),this.trigger("data",t);return}if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(r),e){t={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(t.number=parseInt(e[1],10)),this.trigger("data",t);return}if(e=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(r),e){t={type:"tag",tagType:"playlist-type"},e[1]&&(t.playlistType=e[1]),this.trigger("data",t);return}if(e=/^#EXT-X-BYTERANGE:(.*)?$/.exec(r),e){t=R(D(e[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",t);return}if(e=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(r),e){t={type:"tag",tagType:"allow-cache"},e[1]&&(t.allowed=!/NO/.test(e[1])),this.trigger("data",t);return}if(e=/^#EXT-X-MAP:(.*)$/.exec(r),e){if(t={type:"tag",tagType:"map"},e[1]){const o=E(e[1]);o.URI&&(t.uri=o.URI),o.BYTERANGE&&(t.byterange=D(o.BYTERANGE))}this.trigger("data",t);return}if(e=/^#EXT-X-STREAM-INF:(.*)$/.exec(r),e){if(t={type:"tag",tagType:"stream-inf"},e[1]){if(t.attributes=E(e[1]),t.attributes.RESOLUTION){const o=t.attributes.RESOLUTION.split("x"),u={};o[0]&&(u.width=parseInt(o[0],10)),o[1]&&(u.height=parseInt(o[1],10)),t.attributes.RESOLUTION=u}t.attributes.BANDWIDTH&&(t.attributes.BANDWIDTH=parseInt(t.attributes.BANDWIDTH,10)),t.attributes["FRAME-RATE"]&&(t.attributes["FRAME-RATE"]=parseFloat(t.attributes["FRAME-RATE"])),t.attributes["PROGRAM-ID"]&&(t.attributes["PROGRAM-ID"]=parseInt(t.attributes["PROGRAM-ID"],10))}this.trigger("data",t);return}if(e=/^#EXT-X-MEDIA:(.*)$/.exec(r),e){t={type:"tag",tagType:"media"},e[1]&&(t.attributes=E(e[1])),this.trigger("data",t);return}if(e=/^#EXT-X-ENDLIST/.exec(r),e){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(e=/^#EXT-X-DISCONTINUITY/.exec(r),e){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(e=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(r),e){t={type:"tag",tagType:"program-date-time"},e[1]&&(t.dateTimeString=e[1],t.dateTimeObject=new Date(e[1])),this.trigger("data",t);return}if(e=/^#EXT-X-KEY:(.*)$/.exec(r),e){t={type:"tag",tagType:"key"},e[1]&&(t.attributes=E(e[1]),t.attributes.IV&&(t.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(t.attributes.IV=t.attributes.IV.substring(2)),t.attributes.IV=t.attributes.IV.match(/.{8}/g),t.attributes.IV[0]=parseInt(t.attributes.IV[0],16),t.attributes.IV[1]=parseInt(t.attributes.IV[1],16),t.attributes.IV[2]=parseInt(t.attributes.IV[2],16),t.attributes.IV[3]=parseInt(t.attributes.IV[3],16),t.attributes.IV=new Uint32Array(t.attributes.IV))),this.trigger("data",t);return}if(e=/^#EXT-X-START:(.*)$/.exec(r),e){t={type:"tag",tagType:"start"},e[1]&&(t.attributes=E(e[1]),t.attributes["TIME-OFFSET"]=parseFloat(t.attributes["TIME-OFFSET"]),t.attributes.PRECISE=/YES/.test(t.attributes.PRECISE)),this.trigger("data",t);return}if(e=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(r),e){t={type:"tag",tagType:"cue-out-cont"},e[1]?t.data=e[1]:t.data="",this.trigger("data",t);return}if(e=/^#EXT-X-CUE-OUT:(.*)?$/.exec(r),e){t={type:"tag",tagType:"cue-out"},e[1]?t.data=e[1]:t.data="",this.trigger("data",t);return}if(e=/^#EXT-X-CUE-IN:(.*)?$/.exec(r),e){t={type:"tag",tagType:"cue-in"},e[1]?t.data=e[1]:t.data="",this.trigger("data",t);return}if(e=/^#EXT-X-SKIP:(.*)$/.exec(r),e&&e[1]){t={type:"tag",tagType:"skip"},t.attributes=E(e[1]),t.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(t.attributes["SKIPPED-SEGMENTS"]=parseInt(t.attributes["SKIPPED-SEGMENTS"],10)),t.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(t.attributes["RECENTLY-REMOVED-DATERANGES"]=t.attributes["RECENTLY-REMOVED-DATERANGES"].split(j)),this.trigger("data",t);return}if(e=/^#EXT-X-PART:(.*)$/.exec(r),e&&e[1]){t={type:"tag",tagType:"part"},t.attributes=E(e[1]),["DURATION"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=parseFloat(t.attributes[o]))}),["INDEPENDENT","GAP"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=/YES/.test(t.attributes[o]))}),t.attributes.hasOwnProperty("BYTERANGE")&&(t.attributes.byterange=D(t.attributes.BYTERANGE)),this.trigger("data",t);return}if(e=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(r),e&&e[1]){t={type:"tag",tagType:"server-control"},t.attributes=E(e[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=parseFloat(t.attributes[o]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=/YES/.test(t.attributes[o]))}),this.trigger("data",t);return}if(e=/^#EXT-X-PART-INF:(.*)$/.exec(r),e&&e[1]){t={type:"tag",tagType:"part-inf"},t.attributes=E(e[1]),["PART-TARGET"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=parseFloat(t.attributes[o]))}),this.trigger("data",t);return}if(e=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(r),e&&e[1]){t={type:"tag",tagType:"preload-hint"},t.attributes=E(e[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(o){if(t.attributes.hasOwnProperty(o)){t.attributes[o]=parseInt(t.attributes[o],10);const u=o==="BYTERANGE-LENGTH"?"length":"offset";t.attributes.byterange=t.attributes.byterange||{},t.attributes.byterange[u]=t.attributes[o],delete t.attributes[o]}}),this.trigger("data",t);return}if(e=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(r),e&&e[1]){t={type:"tag",tagType:"rendition-report"},t.attributes=E(e[1]),["LAST-MSN","LAST-PART"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=parseInt(t.attributes[o],10))}),this.trigger("data",t);return}this.trigger("data",{type:"tag",data:r.slice(4)})})}addParser({expression:s,customType:e,dataParser:t,segment:a}){typeof t!="function"&&(t=r=>r),this.customParsers.push(r=>{if(s.exec(r))return this.trigger("data",{type:"custom",data:t(r),customType:e,segment:a}),!0})}addTagMapper({expression:s,map:e}){const t=a=>s.test(a)?e(a):a;this.tagMappers.push(t)}}const W=n=>n.toLowerCase().replace(/-(\w)/g,s=>s[1].toUpperCase()),O=function(n){const s={};return Object.keys(n).forEach(function(e){s[W(e)]=n[e]}),s},N=function(n){const{serverControl:s,targetDuration:e,partTargetDuration:t}=n;if(!s)return;const a="#EXT-X-SERVER-CONTROL",r="holdBack",o="partHoldBack",u=e&&e*3,g=t&&t*2;e&&!s.hasOwnProperty(r)&&(s[r]=u,this.trigger("info",{message:`${a} defaulting HOLD-BACK to targetDuration * 3 (${u}).`})),u&&s[r]<u&&(this.trigger("warn",{message:`${a} clamping HOLD-BACK (${s[r]}) to targetDuration * 3 (${u})`}),s[r]=u),t&&!s.hasOwnProperty(o)&&(s[o]=t*3,this.trigger("info",{message:`${a} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${s[o]}).`})),t&&s[o]<g&&(this.trigger("warn",{message:`${a} clamping PART-HOLD-BACK (${s[o]}) to partTargetDuration * 2 (${g}).`}),s[o]=g)};class X extends P{constructor(){super(),this.lineStream=new K,this.parseStream=new _,this.lineStream.pipe(this.parseStream);const s=this,e=[];let t={},a,r,o=!1;const u=function(){},g={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},l="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let c=0;this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};let b=0,d=0;this.on("end",()=>{t.uri||!t.parts&&!t.preloadHints||(!t.map&&a&&(t.map=a),!t.key&&r&&(t.key=r),!t.timeline&&typeof c=="number"&&(t.timeline=c),this.manifest.preloadSegment=t)}),this.parseStream.on("data",function(i){let m,h;({tag(){({version(){i.version&&(this.manifest.version=i.version)},"allow-cache"(){this.manifest.allowCache=i.allowed,"allowed"in i||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const f={};"length"in i&&(t.byterange=f,f.length=i.length,"offset"in i||(i.offset=b)),"offset"in i&&(t.byterange=f,f.offset=i.offset),b=f.offset+f.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),i.duration>0&&(t.duration=i.duration),i.duration===0&&(t.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=e},key(){if(!i.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(i.attributes.METHOD==="NONE"){r=null;return}if(!i.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(i.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:i.attributes};return}if(i.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:i.attributes.URI};return}if(i.attributes.KEYFORMAT===l){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(i.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(i.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),i.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(i.attributes.KEYID&&i.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:i.attributes.KEYFORMAT,keyId:i.attributes.KEYID.substring(2)},pssh:k(i.attributes.URI.split(",")[1])};return}i.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),r={method:i.attributes.METHOD||"AES-128",uri:i.attributes.URI},typeof i.attributes.IV<"u"&&(r.iv=i.attributes.IV)},"media-sequence"(){if(!isFinite(i.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+i.number});return}this.manifest.mediaSequence=i.number},"discontinuity-sequence"(){if(!isFinite(i.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+i.number});return}this.manifest.discontinuitySequence=i.number,c=i.number},"playlist-type"(){if(!/VOD|EVENT/.test(i.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+i.playlist});return}this.manifest.playlistType=i.playlistType},map(){a={},i.uri&&(a.uri=i.uri),i.byterange&&(a.byterange=i.byterange),r&&(a.key=r)},"stream-inf"(){if(this.manifest.playlists=e,this.manifest.mediaGroups=this.manifest.mediaGroups||g,!i.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}t.attributes||(t.attributes={}),R(t.attributes,i.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||g,!(i.attributes&&i.attributes.TYPE&&i.attributes["GROUP-ID"]&&i.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const f=this.manifest.mediaGroups[i.attributes.TYPE];f[i.attributes["GROUP-ID"]]=f[i.attributes["GROUP-ID"]]||{},m=f[i.attributes["GROUP-ID"]],h={default:/yes/i.test(i.attributes.DEFAULT)},h.default?h.autoselect=!0:h.autoselect=/yes/i.test(i.attributes.AUTOSELECT),i.attributes.LANGUAGE&&(h.language=i.attributes.LANGUAGE),i.attributes.URI&&(h.uri=i.attributes.URI),i.attributes["INSTREAM-ID"]&&(h.instreamId=i.attributes["INSTREAM-ID"]),i.attributes.CHARACTERISTICS&&(h.characteristics=i.attributes.CHARACTERISTICS),i.attributes.FORCED&&(h.forced=/yes/i.test(i.attributes.FORCED)),m[i.attributes.NAME]=h},discontinuity(){c+=1,t.discontinuity=!0,this.manifest.discontinuityStarts.push(e.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=i.dateTimeString,this.manifest.dateTimeObject=i.dateTimeObject),t.dateTimeString=i.dateTimeString,t.dateTimeObject=i.dateTimeObject},targetduration(){if(!isFinite(i.duration)||i.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+i.duration});return}this.manifest.targetDuration=i.duration,N.call(this,this.manifest)},start(){if(!i.attributes||isNaN(i.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:i.attributes["TIME-OFFSET"],precise:i.attributes.PRECISE}},"cue-out"(){t.cueOut=i.data},"cue-out-cont"(){t.cueOutCont=i.data},"cue-in"(){t.cueIn=i.data},skip(){this.manifest.skip=O(i.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",i.attributes,["SKIPPED-SEGMENTS"])},part(){o=!0;const f=this.manifest.segments.length,p=O(i.attributes);t.parts=t.parts||[],t.parts.push(p),p.byterange&&(p.byterange.hasOwnProperty("offset")||(p.byterange.offset=d),d=p.byterange.offset+p.byterange.length);const T=t.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${T} for segment #${f}`,i.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((I,A)=>{I.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${A} lacks required attribute(s): LAST-PART`})})},"server-control"(){const f=this.manifest.serverControl=O(i.attributes);f.hasOwnProperty("canBlockReload")||(f.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),N.call(this,this.manifest),f.canSkipDateranges&&!f.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const f=this.manifest.segments.length,p=O(i.attributes),T=p.type&&p.type==="PART";t.preloadHints=t.preloadHints||[],t.preloadHints.push(p),p.byterange&&(p.byterange.hasOwnProperty("offset")||(p.byterange.offset=T?d:0,T&&(d=p.byterange.offset+p.byterange.length)));const I=t.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${I} for segment #${f}`,i.attributes,["TYPE","URI"]),!!p.type)for(let A=0;A<t.preloadHints.length-1;A++){const x=t.preloadHints[A];x.type&&x.type===p.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${I} for segment #${f} has the same TYPE ${p.type} as preload hint #${A}`})}},"rendition-report"(){const f=O(i.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(f);const p=this.manifest.renditionReports.length-1,T=["LAST-MSN","URI"];o&&T.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${p}`,i.attributes,T)},"part-inf"(){this.manifest.partInf=O(i.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",i.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),N.call(this,this.manifest)}}[i.tagType]||u).call(s)},uri(){t.uri=i.uri,e.push(t),this.manifest.targetDuration&&!("duration"in t)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),t.duration=this.manifest.targetDuration),r&&(t.key=r),t.timeline=c,a&&(t.map=a),d=0,t={}},comment(){},custom(){i.segment?(t.custom=t.custom||{},t.custom[i.customType]=i.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[i.customType]=i.data)}})[i.type].call(s)})}warnOnMissingAttributes_(s,e,t){const a=[];t.forEach(function(r){e.hasOwnProperty(r)||a.push(r)}),a.length&&this.trigger("warn",{message:`${s} lacks required attribute(s): ${a.join(", ")}`})}push(s){this.lineStream.push(s)}end(){this.lineStream.push(`
`),this.trigger("end")}addParser(s){this.parseStream.addParser(s)}addTagMapper(s){this.parseStream.addTagMapper(s)}}function U(n){return n.substring(0,n.lastIndexOf("/"))}function z(n){return new Promise((s,e)=>{setTimeout(()=>{fetch(n,{cache:"no-store"}).then(t=>t.text()).then(t=>{const a=new X;a.push(t),a.end(),s(a.manifest)}).catch(e)},0)})}function Q(n){return new Promise((s,e)=>{setTimeout(async()=>{var t;try{const a=await z(n),r=U(n);if(a.playlists instanceof Array&&a.playlists.length>0){const o=(t=a.mediaGroups)==null?void 0:t.SUBTITLES;if(o&&o["sub-main"]){const u=o["sub-main"],g=[];for(const l of Object.keys(u)){if(l.includes("--forced--"))continue;const c=u[l];if(c&&typeof c.language=="string"&&typeof c.uri=="string"){const b=async()=>{const d=`${r}/${c.uri}`,i=await fetch(d),m=new X;m.push(await i.text()),m.end();const h=m.manifest.segments[0].uri,f=h.substring(h.lastIndexOf(".")+1),p=U(d),T=m.manifest.segments.filter(I=>!I.discontinuity&&I.uri).map(I=>`${p}/${I.uri}`);return F({label:l,language:c.language,url:T,extension:f})};g.push(b())}}s(await Promise.all(g));return}}e(new Error("Subtitles not found."))}catch(a){e(a)}},0)})}const Z=n=>{const s=async a=>{var b;const r=await(await fetch(a)).text(),o=new X({url:a});o.push(r),o.end();const g=(b=o.manifest.mediaGroups)==null?void 0:b.SUBTITLES;if(typeof g!="object")return[];const l=new URL(a);let c=`${l.origin}/${l.pathname}`;c=c.substring(0,c.lastIndexOf("/"));for(const[,d]of Object.entries(g))if(!(typeof d!="object"||!d))for(const[i,m]of Object.entries(d)){if(typeof m!="object"||!m)continue;const h=m.uri,f=m.language;if(!(!h||!f))return await Q(h)}return[]};let e;const t=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(){const a=arguments[1];typeof a=="string"&&n.test(a)&&(e=a),t.apply(this,arguments)},B({onRequest:async(a,r)=>{if(r(document.title),e!==void 0){const o=await s(e);for(const u of o)a(u)}},waitForBasename:!1})},J=$(()=>{Z(/https:\/\/.+\.m3u8.+/)});function et(){}function S(n,...s){}const tt={debug:(...n)=>S(console.debug,...n),log:(...n)=>S(console.log,...n),warn:(...n)=>S(console.warn,...n),error:(...n)=>S(console.error,...n)};return(async()=>{try{return await J.main()}catch(n){throw tt.error('The unlisted script "areena-yle-page" crashed on startup!',n),n}})()}();
areenaYlePage;
