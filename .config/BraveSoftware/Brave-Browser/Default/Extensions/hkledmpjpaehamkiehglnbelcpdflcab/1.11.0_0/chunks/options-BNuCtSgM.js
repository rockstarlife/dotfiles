import{b as c}from"./index-BNzDLOmD.js";import{r as t,S as b,E as j,u as k,j as a,s as P,c as T,b as E,i as F,v as B,m as L,h as D,d as U,f as M,P as R,e as A,T as I,C as O,k as N}from"./Tooltip-CHkWPQyT.js";import{u as H,A as K,H as W,a as z,b as Y,S as q,c as G}from"./SettingsProfileSelectMenu-DvRtSy1I.js";import{u as f}from"./mp3-encoder-CoEoOaGq.js";import{b as V,g as J,D as Q,a as X}from"./DialogContent-UtFnDA1U.js";import{B as Z}from"./index-BSUPl2ka.js";import{S as _}from"./Input-CyGuovd8.js";import"./TableContainer-CRv4wqnM.js";import"./index-DGAt_zbA.js";import"./LogoIcon-B8iZypNR.js";import"./TutorialBubble-5H5VcrSJ.js";const $=async({imageUrl:e,audioUrl:s})=>({subtitle:{text:`So therefore the way to work towards perfection is simply to keep going, to enjoy the language.
-Steve Kaufmann`,start:288925,end:294695,originalStart:288925,originalEnd:294695,track:0},text:`So therefore the way to work towards perfection is simply to keep going, to enjoy the language.
-Steve Kaufmann`,word:"enjoy",definition:"take delight or pleasure in (an activity or occasion).",surroundingSubtitles:[],subtitleFileName:"You Don't Have to Be Perfect to Become Fluent.srt",url:"https://www.youtube.com/watch?v=eO4d6iueGzY",image:{base64:await f(e),extension:"jpeg"},audio:{base64:await f(s),extension:"mp3",paddingStart:0,paddingEnd:1e3},mediaTimestamp:288925}),ee=()=>{const e=t.useMemo(()=>new b(new j),[]),[s,i]=t.useState(),o=t.useCallback(()=>e.getAll().then(i),[e]);t.useEffect(()=>{o()},[o]),t.useEffect(()=>{c.runtime.onMessage.addListener((r,u,g)=>{var p;((p=r.message)==null?void 0:p.command)==="settings-updated"&&e.getAll().then(i)})},[e]);const n=t.useCallback(()=>{const r={sender:"asbplayer-settings",message:{command:"settings-updated"}};c.runtime.sendMessage(r)},[]),d=t.useCallback(r=>{i(u=>({...u,...r})),e.set(r).then(()=>n())},[e,n]),m=t.useCallback(()=>{o(),n()},[o,n]),l=H({settingsProvider:e,onProfileChanged:m});return{settings:s,onSettingsChanged:d,profileContext:l}},te=e=>{const{classes:s}=e;return E({root:["root"]},J,s)},se=P(F,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,s)=>s.root})({padding:"16px 24px",flex:"0 0 auto"}),oe=t.forwardRef(function(s,i){const o=k({props:s,name:"MuiDialogTitle"}),{className:n,id:d,...m}=o,l=o,r=te(l),{titleId:u=d}=t.useContext(V);return a.jsx(se,{component:"h2",className:T(r.root,n),ownerState:l,ref:i,variant:"h6",id:d??u,...m})}),ne=()=>{const[e,s]=t.useState();return t.useEffect(()=>{if(c.commands===void 0){s({});return}c.commands.getAll().then(i=>{const o={};for(const n of i)n.name&&n.shortcut&&(o[n.name]=n.shortcut);s(B(o))})},[]),e},ae=L(e=>({root:{"& .MuiPaper-root":{height:"100vh"}},content:{maxHeight:"100%"},profilesContainer:{paddingLeft:e.spacing(4),paddingRight:e.spacing(4)}})),ie=()=>$({imageUrl:c.runtime.getURL("/assets/test-card.jpeg"),audioUrl:c.runtime.getURL("/assets/test-card.mp3")}),re=({settings:e,inTutorial:s,onSettingsChanged:i,...o})=>{const{t:n}=D(),d=U(),m=t.useMemo(()=>e===void 0?void 0:new K(e,new W),[e]),l=ae(),{updateLocalFontsPermission:r,updateLocalFonts:u,localFontsAvailable:g,localFontsPermission:p,localFontFamilies:x}=z(),S=t.useCallback(()=>{r(),u()},[r,u]),h=ne(),C=t.useCallback(()=>{c.tabs.create({active:!0,url:"chrome://extensions/shortcuts"})},[]),{initialized:y}=M({language:(e==null?void 0:e.language)??"en"}),v=t.useMemo(()=>{if(location.hash&&location.hash.startsWith("#"))return location.hash.substring(1,location.hash.length)},[]),{supportedLanguages:w}=Y();return!e||!m||!h||!y?null:a.jsx(R,{square:!0,style:{height:"100vh"},children:a.jsxs(Q,{open:!0,maxWidth:"md",fullWidth:!0,className:l.root,onClose:()=>{},children:[a.jsx(oe,{children:n("settings.title")}),a.jsx(X,{className:l.content,children:a.jsx(q,{anki:m,extensionInstalled:!0,extensionVersion:c.runtime.getManifest().version,extensionSupportsAppIntegration:!0,extensionSupportsOverlay:!0,extensionSupportsSidePanel:!0,extensionSupportsOrderableAnkiFields:!0,extensionSupportsTrackSpecificSettings:!0,extensionSupportsSubtitlesWidthSetting:!0,extensionSupportsPauseOnHover:!0,extensionSupportsExportCardBind:!0,chromeKeyBinds:h,onOpenChromeExtensionShortcuts:C,onSettingsChanged:i,settings:e,localFontsAvailable:g,localFontsPermission:p,localFontFamilies:x,supportedLanguages:w,onUnlockLocalFonts:S,scrollToId:v,inTutorial:s,testCard:ie})}),a.jsx(Z,{style:{marginBottom:d.spacing(2)},className:l.profilesContainer,children:a.jsx(G,{...o})})]})})},le=new URLSearchParams(window.location.search).get("tutorial")==="true",ce=()=>{const{settings:e,onSettingsChanged:s,profileContext:i}=ee(),o=t.useMemo(()=>e&&A(e.themeType),[e]);return!e||!o?null:a.jsx(_,{injectFirst:!0,children:a.jsxs(I,{theme:o,children:[a.jsx(O,{}),a.jsx(re,{settings:e,onSettingsChanged:s,inTutorial:le,...i})]})})},ue=e=>{N.createRoot(e).render(a.jsx(ce,{}))};window.addEventListener("load",()=>{const e=document.getElementById("root");ue(e)});
