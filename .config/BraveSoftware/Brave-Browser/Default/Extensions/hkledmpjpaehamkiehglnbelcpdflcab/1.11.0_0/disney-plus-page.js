var disneyPlusPage=function(){"use strict";function $(r){return r==null||typeof r=="function"?{main:r}:r}function G(r,s=1e4){return new Promise(async(e,t)=>{r()&&e(!0);const n=Date.now();let a=!1;for(;!a&&Date.now()<n+s;)await new Promise(o=>{setTimeout(()=>{a=r(),o()},1e3)});e(a)})}const F=r=>({id:P(r),...r}),P=r=>`${r.language}:${r.label}:${r.url}`;function B({onJson:r,onRequest:s,waitForBasename:e},t){setTimeout(()=>{const n={};let a="",o=!1;if(r!==void 0){const c=JSON.parse;JSON.parse=function(){const d=c.apply(this,arguments);let g=!1,m=!1;return r==null||r(d,l=>{const i=window.location.pathname;typeof n[i]>"u"&&(n[i]=[]);const b=P(l);n[i].find(h=>h.id===b)===void 0&&(n[i].push({id:b,...l}),g=!0)},l=>{a=l,m=!0}),o&&(g||m)&&document.dispatchEvent(new CustomEvent("asbplayer-synced-data",{detail:{error:"",basename:a,subtitles:n[window.location.pathname]}})),d}}function u(){for(const c of Object.keys(n))c!==window.location.pathname&&delete n[c]}document.addEventListener("asbplayer-get-synced-data",async()=>{s==null||s(d=>{const g=window.location.pathname;typeof n[g]>"u"&&(n[g]=[]);const m=P(d);n[g].find(l=>l.id===m)===void 0&&n[g].push({id:m,...d})},d=>{a=d,o||document.dispatchEvent(new CustomEvent("asbplayer-synced-data",{detail:{error:"",basename:a,subtitles:void 0}}))});const c=()=>window.location.pathname in n;c()||await G(c,t),document.dispatchEvent(new CustomEvent("asbplayer-synced-data",{detail:{error:"",basename:a,subtitles:n[window.location.pathname]??[]}})),u(),o=!0},!1)},0)}var w=function(){function r(){this.listeners={}}var s=r.prototype;return s.on=function(t,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(n)},s.off=function(t,n){if(!this.listeners[t])return!1;var a=this.listeners[t].indexOf(n);return this.listeners[t]=this.listeners[t].slice(0),this.listeners[t].splice(a,1),a>-1},s.trigger=function(t){var n=this.listeners[t];if(n)if(arguments.length===2)for(var a=n.length,o=0;o<a;++o)n[o].call(this,arguments[1]);else for(var u=Array.prototype.slice.call(arguments,1),c=n.length,d=0;d<c;++d)n[d].apply(this,u)},s.dispose=function(){this.listeners={}},s.pipe=function(t){this.on("data",function(n){t.push(n)})},r}();function R(){return R=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var e=arguments[s];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}return r},R.apply(this,arguments)}var C=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function H(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var y,X;function Y(){if(X)return y;X=1;var r;return typeof window<"u"?r=window:typeof C<"u"?r=C:typeof self<"u"?r=self:r={},y=r,y}var V=Y();const M=H(V);var L=function(s){return M.atob?M.atob(s):Buffer.from(s,"base64").toString("binary")};function K(r){for(var s=L(r),e=new Uint8Array(s.length),t=0;t<s.length;t++)e[t]=s.charCodeAt(t);return e}/*! @name m3u8-parser @version 6.0.0 @license Apache-2.0 */class k extends w{constructor(){super(),this.buffer=""}push(s){let e;for(this.buffer+=s,e=this.buffer.indexOf(`
`);e>-1;e=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)}}const q="	",N=function(r){const s=/([0-9.]*)?@?([0-9.]*)?/.exec(r||""),e={};return s[1]&&(e.length=parseInt(s[1],10)),s[2]&&(e.offset=parseInt(s[2],10)),e},j=function(){const e="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+e+")")},E=function(r){const s={};if(!r)return s;const e=r.split(j());let t=e.length,n;for(;t--;)e[t]!==""&&(n=/([^=]*)=(.*)/.exec(e[t]).slice(1),n[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),s[n[0]]=n[1]);return s};class _ extends w{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(s){let e,t;if(s=s.trim(),s.length===0)return;if(s[0]!=="#"){this.trigger("data",{type:"uri",uri:s});return}this.tagMappers.reduce((a,o)=>{const u=o(s);return u===s?a:a.concat([u])},[s]).forEach(a=>{for(let o=0;o<this.customParsers.length;o++)if(this.customParsers[o].call(this,a))return;if(a.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:a.slice(1)});return}if(a=a.replace("\r",""),e=/^#EXTM3U/.exec(a),e){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(e=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(a),e){t={type:"tag",tagType:"inf"},e[1]&&(t.duration=parseFloat(e[1])),e[2]&&(t.title=e[2]),this.trigger("data",t);return}if(e=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(a),e){t={type:"tag",tagType:"targetduration"},e[1]&&(t.duration=parseInt(e[1],10)),this.trigger("data",t);return}if(e=/^#EXT-X-VERSION:([0-9.]*)?/.exec(a),e){t={type:"tag",tagType:"version"},e[1]&&(t.version=parseInt(e[1],10)),this.trigger("data",t);return}if(e=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(a),e){t={type:"tag",tagType:"media-sequence"},e[1]&&(t.number=parseInt(e[1],10)),this.trigger("data",t);return}if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(a),e){t={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(t.number=parseInt(e[1],10)),this.trigger("data",t);return}if(e=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(a),e){t={type:"tag",tagType:"playlist-type"},e[1]&&(t.playlistType=e[1]),this.trigger("data",t);return}if(e=/^#EXT-X-BYTERANGE:(.*)?$/.exec(a),e){t=R(N(e[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",t);return}if(e=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(a),e){t={type:"tag",tagType:"allow-cache"},e[1]&&(t.allowed=!/NO/.test(e[1])),this.trigger("data",t);return}if(e=/^#EXT-X-MAP:(.*)$/.exec(a),e){if(t={type:"tag",tagType:"map"},e[1]){const o=E(e[1]);o.URI&&(t.uri=o.URI),o.BYTERANGE&&(t.byterange=N(o.BYTERANGE))}this.trigger("data",t);return}if(e=/^#EXT-X-STREAM-INF:(.*)$/.exec(a),e){if(t={type:"tag",tagType:"stream-inf"},e[1]){if(t.attributes=E(e[1]),t.attributes.RESOLUTION){const o=t.attributes.RESOLUTION.split("x"),u={};o[0]&&(u.width=parseInt(o[0],10)),o[1]&&(u.height=parseInt(o[1],10)),t.attributes.RESOLUTION=u}t.attributes.BANDWIDTH&&(t.attributes.BANDWIDTH=parseInt(t.attributes.BANDWIDTH,10)),t.attributes["FRAME-RATE"]&&(t.attributes["FRAME-RATE"]=parseFloat(t.attributes["FRAME-RATE"])),t.attributes["PROGRAM-ID"]&&(t.attributes["PROGRAM-ID"]=parseInt(t.attributes["PROGRAM-ID"],10))}this.trigger("data",t);return}if(e=/^#EXT-X-MEDIA:(.*)$/.exec(a),e){t={type:"tag",tagType:"media"},e[1]&&(t.attributes=E(e[1])),this.trigger("data",t);return}if(e=/^#EXT-X-ENDLIST/.exec(a),e){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(e=/^#EXT-X-DISCONTINUITY/.exec(a),e){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(e=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(a),e){t={type:"tag",tagType:"program-date-time"},e[1]&&(t.dateTimeString=e[1],t.dateTimeObject=new Date(e[1])),this.trigger("data",t);return}if(e=/^#EXT-X-KEY:(.*)$/.exec(a),e){t={type:"tag",tagType:"key"},e[1]&&(t.attributes=E(e[1]),t.attributes.IV&&(t.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(t.attributes.IV=t.attributes.IV.substring(2)),t.attributes.IV=t.attributes.IV.match(/.{8}/g),t.attributes.IV[0]=parseInt(t.attributes.IV[0],16),t.attributes.IV[1]=parseInt(t.attributes.IV[1],16),t.attributes.IV[2]=parseInt(t.attributes.IV[2],16),t.attributes.IV[3]=parseInt(t.attributes.IV[3],16),t.attributes.IV=new Uint32Array(t.attributes.IV))),this.trigger("data",t);return}if(e=/^#EXT-X-START:(.*)$/.exec(a),e){t={type:"tag",tagType:"start"},e[1]&&(t.attributes=E(e[1]),t.attributes["TIME-OFFSET"]=parseFloat(t.attributes["TIME-OFFSET"]),t.attributes.PRECISE=/YES/.test(t.attributes.PRECISE)),this.trigger("data",t);return}if(e=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(a),e){t={type:"tag",tagType:"cue-out-cont"},e[1]?t.data=e[1]:t.data="",this.trigger("data",t);return}if(e=/^#EXT-X-CUE-OUT:(.*)?$/.exec(a),e){t={type:"tag",tagType:"cue-out"},e[1]?t.data=e[1]:t.data="",this.trigger("data",t);return}if(e=/^#EXT-X-CUE-IN:(.*)?$/.exec(a),e){t={type:"tag",tagType:"cue-in"},e[1]?t.data=e[1]:t.data="",this.trigger("data",t);return}if(e=/^#EXT-X-SKIP:(.*)$/.exec(a),e&&e[1]){t={type:"tag",tagType:"skip"},t.attributes=E(e[1]),t.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(t.attributes["SKIPPED-SEGMENTS"]=parseInt(t.attributes["SKIPPED-SEGMENTS"],10)),t.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(t.attributes["RECENTLY-REMOVED-DATERANGES"]=t.attributes["RECENTLY-REMOVED-DATERANGES"].split(q)),this.trigger("data",t);return}if(e=/^#EXT-X-PART:(.*)$/.exec(a),e&&e[1]){t={type:"tag",tagType:"part"},t.attributes=E(e[1]),["DURATION"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=parseFloat(t.attributes[o]))}),["INDEPENDENT","GAP"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=/YES/.test(t.attributes[o]))}),t.attributes.hasOwnProperty("BYTERANGE")&&(t.attributes.byterange=N(t.attributes.BYTERANGE)),this.trigger("data",t);return}if(e=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(a),e&&e[1]){t={type:"tag",tagType:"server-control"},t.attributes=E(e[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=parseFloat(t.attributes[o]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=/YES/.test(t.attributes[o]))}),this.trigger("data",t);return}if(e=/^#EXT-X-PART-INF:(.*)$/.exec(a),e&&e[1]){t={type:"tag",tagType:"part-inf"},t.attributes=E(e[1]),["PART-TARGET"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=parseFloat(t.attributes[o]))}),this.trigger("data",t);return}if(e=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(a),e&&e[1]){t={type:"tag",tagType:"preload-hint"},t.attributes=E(e[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(o){if(t.attributes.hasOwnProperty(o)){t.attributes[o]=parseInt(t.attributes[o],10);const u=o==="BYTERANGE-LENGTH"?"length":"offset";t.attributes.byterange=t.attributes.byterange||{},t.attributes.byterange[u]=t.attributes[o],delete t.attributes[o]}}),this.trigger("data",t);return}if(e=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(a),e&&e[1]){t={type:"tag",tagType:"rendition-report"},t.attributes=E(e[1]),["LAST-MSN","LAST-PART"].forEach(function(o){t.attributes.hasOwnProperty(o)&&(t.attributes[o]=parseInt(t.attributes[o],10))}),this.trigger("data",t);return}this.trigger("data",{type:"tag",data:a.slice(4)})})}addParser({expression:s,customType:e,dataParser:t,segment:n}){typeof t!="function"&&(t=a=>a),this.customParsers.push(a=>{if(s.exec(a))return this.trigger("data",{type:"custom",data:t(a),customType:e,segment:n}),!0})}addTagMapper({expression:s,map:e}){const t=n=>s.test(n)?e(n):n;this.tagMappers.push(t)}}const W=r=>r.toLowerCase().replace(/-(\w)/g,s=>s[1].toUpperCase()),A=function(r){const s={};return Object.keys(r).forEach(function(e){s[W(e)]=r[e]}),s},D=function(r){const{serverControl:s,targetDuration:e,partTargetDuration:t}=r;if(!s)return;const n="#EXT-X-SERVER-CONTROL",a="holdBack",o="partHoldBack",u=e&&e*3,c=t&&t*2;e&&!s.hasOwnProperty(a)&&(s[a]=u,this.trigger("info",{message:`${n} defaulting HOLD-BACK to targetDuration * 3 (${u}).`})),u&&s[a]<u&&(this.trigger("warn",{message:`${n} clamping HOLD-BACK (${s[a]}) to targetDuration * 3 (${u})`}),s[a]=u),t&&!s.hasOwnProperty(o)&&(s[o]=t*3,this.trigger("info",{message:`${n} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${s[o]}).`})),t&&s[o]<c&&(this.trigger("warn",{message:`${n} clamping PART-HOLD-BACK (${s[o]}) to partTargetDuration * 2 (${c}).`}),s[o]=c)};class U extends w{constructor(){super(),this.lineStream=new k,this.parseStream=new _,this.lineStream.pipe(this.parseStream);const s=this,e=[];let t={},n,a,o=!1;const u=function(){},c={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},d="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let g=0;this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};let m=0,l=0;this.on("end",()=>{t.uri||!t.parts&&!t.preloadHints||(!t.map&&n&&(t.map=n),!t.key&&a&&(t.key=a),!t.timeline&&typeof g=="number"&&(t.timeline=g),this.manifest.preloadSegment=t)}),this.parseStream.on("data",function(i){let b,h;({tag(){({version(){i.version&&(this.manifest.version=i.version)},"allow-cache"(){this.manifest.allowCache=i.allowed,"allowed"in i||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const f={};"length"in i&&(t.byterange=f,f.length=i.length,"offset"in i||(i.offset=m)),"offset"in i&&(t.byterange=f,f.offset=i.offset),m=f.offset+f.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),i.duration>0&&(t.duration=i.duration),i.duration===0&&(t.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=e},key(){if(!i.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(i.attributes.METHOD==="NONE"){a=null;return}if(!i.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(i.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:i.attributes};return}if(i.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:i.attributes.URI};return}if(i.attributes.KEYFORMAT===d){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(i.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(i.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),i.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(i.attributes.KEYID&&i.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:i.attributes.KEYFORMAT,keyId:i.attributes.KEYID.substring(2)},pssh:K(i.attributes.URI.split(",")[1])};return}i.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:i.attributes.METHOD||"AES-128",uri:i.attributes.URI},typeof i.attributes.IV<"u"&&(a.iv=i.attributes.IV)},"media-sequence"(){if(!isFinite(i.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+i.number});return}this.manifest.mediaSequence=i.number},"discontinuity-sequence"(){if(!isFinite(i.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+i.number});return}this.manifest.discontinuitySequence=i.number,g=i.number},"playlist-type"(){if(!/VOD|EVENT/.test(i.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+i.playlist});return}this.manifest.playlistType=i.playlistType},map(){n={},i.uri&&(n.uri=i.uri),i.byterange&&(n.byterange=i.byterange),a&&(n.key=a)},"stream-inf"(){if(this.manifest.playlists=e,this.manifest.mediaGroups=this.manifest.mediaGroups||c,!i.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}t.attributes||(t.attributes={}),R(t.attributes,i.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||c,!(i.attributes&&i.attributes.TYPE&&i.attributes["GROUP-ID"]&&i.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const f=this.manifest.mediaGroups[i.attributes.TYPE];f[i.attributes["GROUP-ID"]]=f[i.attributes["GROUP-ID"]]||{},b=f[i.attributes["GROUP-ID"]],h={default:/yes/i.test(i.attributes.DEFAULT)},h.default?h.autoselect=!0:h.autoselect=/yes/i.test(i.attributes.AUTOSELECT),i.attributes.LANGUAGE&&(h.language=i.attributes.LANGUAGE),i.attributes.URI&&(h.uri=i.attributes.URI),i.attributes["INSTREAM-ID"]&&(h.instreamId=i.attributes["INSTREAM-ID"]),i.attributes.CHARACTERISTICS&&(h.characteristics=i.attributes.CHARACTERISTICS),i.attributes.FORCED&&(h.forced=/yes/i.test(i.attributes.FORCED)),b[i.attributes.NAME]=h},discontinuity(){g+=1,t.discontinuity=!0,this.manifest.discontinuityStarts.push(e.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=i.dateTimeString,this.manifest.dateTimeObject=i.dateTimeObject),t.dateTimeString=i.dateTimeString,t.dateTimeObject=i.dateTimeObject},targetduration(){if(!isFinite(i.duration)||i.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+i.duration});return}this.manifest.targetDuration=i.duration,D.call(this,this.manifest)},start(){if(!i.attributes||isNaN(i.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:i.attributes["TIME-OFFSET"],precise:i.attributes.PRECISE}},"cue-out"(){t.cueOut=i.data},"cue-out-cont"(){t.cueOutCont=i.data},"cue-in"(){t.cueIn=i.data},skip(){this.manifest.skip=A(i.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",i.attributes,["SKIPPED-SEGMENTS"])},part(){o=!0;const f=this.manifest.segments.length,p=A(i.attributes);t.parts=t.parts||[],t.parts.push(p),p.byterange&&(p.byterange.hasOwnProperty("offset")||(p.byterange.offset=l),l=p.byterange.offset+p.byterange.length);const T=t.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${T} for segment #${f}`,i.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((I,O)=>{I.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${O} lacks required attribute(s): LAST-PART`})})},"server-control"(){const f=this.manifest.serverControl=A(i.attributes);f.hasOwnProperty("canBlockReload")||(f.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),D.call(this,this.manifest),f.canSkipDateranges&&!f.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const f=this.manifest.segments.length,p=A(i.attributes),T=p.type&&p.type==="PART";t.preloadHints=t.preloadHints||[],t.preloadHints.push(p),p.byterange&&(p.byterange.hasOwnProperty("offset")||(p.byterange.offset=T?l:0,T&&(l=p.byterange.offset+p.byterange.length)));const I=t.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${I} for segment #${f}`,i.attributes,["TYPE","URI"]),!!p.type)for(let O=0;O<t.preloadHints.length-1;O++){const x=t.preloadHints[O];x.type&&x.type===p.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${I} for segment #${f} has the same TYPE ${p.type} as preload hint #${O}`})}},"rendition-report"(){const f=A(i.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(f);const p=this.manifest.renditionReports.length-1,T=["LAST-MSN","URI"];o&&T.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${p}`,i.attributes,T)},"part-inf"(){this.manifest.partInf=A(i.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",i.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),D.call(this,this.manifest)}}[i.tagType]||u).call(s)},uri(){t.uri=i.uri,e.push(t),this.manifest.targetDuration&&!("duration"in t)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),t.duration=this.manifest.targetDuration),a&&(t.key=a),t.timeline=g,n&&(t.map=n),l=0,t={}},comment(){},custom(){i.segment?(t.custom=t.custom||{},t.custom[i.customType]=i.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[i.customType]=i.data)}})[i.type].call(s)})}warnOnMissingAttributes_(s,e,t){const n=[];t.forEach(function(a){e.hasOwnProperty(a)||n.push(a)}),n.length&&this.trigger("warn",{message:`${s} lacks required attribute(s): ${n.join(", ")}`})}push(s){this.lineStream.push(s)}end(){this.lineStream.push(`
`),this.trigger("end")}addParser(s){this.parseStream.addParser(s)}addTagMapper(s){this.parseStream.addTagMapper(s)}}function v(r){return r.substring(0,r.lastIndexOf("/"))}function z(r){return new Promise((s,e)=>{setTimeout(()=>{fetch(r,{cache:"no-store"}).then(t=>t.text()).then(t=>{const n=new U;n.push(t),n.end(),s(n.manifest)}).catch(e)},0)})}function Q(r){return new Promise((s,e)=>{setTimeout(async()=>{var t;try{const n=await z(r),a=v(r);if(n.playlists instanceof Array&&n.playlists.length>0){const o=(t=n.mediaGroups)==null?void 0:t.SUBTITLES;if(o&&o["sub-main"]){const u=o["sub-main"],c=[];for(const d of Object.keys(u)){if(d.includes("--forced--"))continue;const g=u[d];if(g&&typeof g.language=="string"&&typeof g.uri=="string"){const m=async()=>{const l=`${a}/${g.uri}`,i=await fetch(l),b=new U;b.push(await i.text()),b.end();const h=b.manifest.segments[0].uri,f=h.substring(h.lastIndexOf(".")+1),p=v(l),T=b.manifest.segments.filter(I=>!I.discontinuity&&I.uri).map(I=>`${p}/${I.uri}`);return F({label:d,language:g.language,url:T,extension:f})};c.push(m())}}s(await Promise.all(c));return}}e(new Error("Subtitles not found."))}catch(n){e(n)}},0)})}const Z=$(()=>{setTimeout(()=>{let r,s;const e=JSON.parse;JSON.parse=function(){var n,a,o,u,c,d,g,m,l,i;const t=e.apply(this,arguments);if(((n=t==null?void 0:t.stream)==null?void 0:n.sources)instanceof Array&&t.stream.sources.length>0){const b=(a=t.stream.sources[0].complete)==null?void 0:a.url;b&&(r=b)}return(u=(o=t==null?void 0:t.data)==null?void 0:o.playerExperience)!=null&&u.title&&(s=(d=(c=t==null?void 0:t.data)==null?void 0:c.playerExperience)==null?void 0:d.title,(m=(g=t==null?void 0:t.data)==null?void 0:g.playerExperience)!=null&&m.subtitle&&(s+=` ${(i=(l=t==null?void 0:t.data)==null?void 0:l.playerExperience)==null?void 0:i.subtitle}`)),t},B({onRequest:async(t,n)=>{if(s!==void 0&&n(s),r!==void 0){const a=await Q(r);for(const o of a)t(o)}},waitForBasename:!1},6e4)},0)});function tt(){}function S(r,...s){}const J={debug:(...r)=>S(console.debug,...r),log:(...r)=>S(console.log,...r),warn:(...r)=>S(console.warn,...r),error:(...r)=>S(console.error,...r)};return(async()=>{try{return await Z.main()}catch(r){throw J.error('The unlisted script "disney-plus-page" crashed on startup!',r),r}})()}();
disneyPlusPage;
